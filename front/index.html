<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dogs | Home</title>
  </head>
  <body>
    <h1>Dogs</h1>


    <form id="enviar">
      <input type="file" name="img">
      <button>enviar</button>
    </form>

  </body>

  <script>
    async function loginUser() {
      const response = await fetch("http://localhost:3000/auth/session", {
        method: "GET",
      });
      const dados = await response.json();
      console.log(dados)
    }

    loginUser()
    async function LogoutloginUser() {
      const response = await fetch("http://localhost:3000/teste")

      const dados = await response.json();
      console.log('teste',dados);
    }
    LogoutloginUser()

     async function login() {
      const response = await fetch("http://localhost:3000/auth/login",{
        method:'POST',
        headers:{
          'Content-Type':'application/json'
        },
        body:JSON.stringify({email:"rafael@gmail.com",password:'123'})
      })

      const dados = await response.json();
      console.log(dados);
    }
    login()

    const formFile = document.querySelector('#enviar')
    const inputFile = formFile.querySelector('input')

    formFile.addEventListener("submit",async(e) =>{
      e.preventDefault()
      for(const file of inputFile.files){
        console.log(file)
        const response = await fetch("http://localhost:3000/upload/file", {
        method: "POST",       
        headers:{
          'Content-Type':'application/octet-stream',
          'x-filename':file.name
        },
        body: file
      });
      const dados = await response.text();
      console.log(dados);
    }
    
  })


    async function forgot() {
      const response = await fetch(
        "http://localhost:3000/auth/password/forgot",
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ email: "rafael" }),
        },
      );
      const dados = await response.json();
      console.log(dados);
    }

    async function resetToken() {
      const response = await fetch(
        "http://localhost:3000/auth/password/reset",
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            token: "4-g3DPCM0VzWJtYT4ZiInyPmza80ImPr12sbnjd8U9M",
            new_password: "123",
          }),
        },
      );
      const dados = await response.json();
      console.log(dados);
    }
  </script>
</html>
